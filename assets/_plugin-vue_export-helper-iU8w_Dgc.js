import{x as M,h as f,e as v,y as n}from"./index-D7fGuzYZ.js";const _=M("habits",()=>{const i=f([]),r=f(!1),l=f(!0),u=v(()=>i.value.filter(s=>!s.archived)),h=v(()=>i.value.filter(s=>s.archived));async function d(){var s,o;r.value=!0;try{const t=await n.getHabits(),a=new Map;for(const e of t){if(a.has(e.id)){console.warn("å‘çŽ°é‡å¤ä¹ æƒ¯ï¼Œè·³è¿‡:",e.id,e.name);continue}const c=await n.getRecords(e.id),g=n.convertHabitFromAPI(e,c);a.set(g.id,g)}i.value=Array.from(a.values())}catch(t){const a=(t==null?void 0:t.message)||((o=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:o.message)||"åŠ è½½ä¹ æƒ¯å¤±è´¥";throw console.error("åŠ è½½ä¹ æƒ¯å¤±è´¥:",a,t),t}finally{r.value=!1}}async function b(s,o){var t,a;try{await n.toggleRecord(s,o),await d()}catch(e){const c=(e==null?void 0:e.message)||((a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message)||"åˆ‡æ¢æ‰“å¡çŠ¶æ€å¤±è´¥";throw console.error("åˆ‡æ¢æ‰“å¡çŠ¶æ€å¤±è´¥:",c,e),e}}async function m(s,o,t){var a,e;try{await n.createHabit({name:s.trim(),emoji:o||"ðŸ“",color:t||"#10b981",archived:!1}),await d()}catch(c){const g=(c==null?void 0:c.message)||((e=(a=c==null?void 0:c.response)==null?void 0:a.data)==null?void 0:e.message)||"æ·»åŠ ä¹ æƒ¯å¤±è´¥";throw console.error("æ·»åŠ ä¹ æƒ¯å¤±è´¥:",g,c),c}}async function p(s,o){var t,a;try{await n.updateHabit(s,o),await d()}catch(e){const c=(e==null?void 0:e.message)||((a=(t=e==null?void 0:e.response)==null?void 0:t.data)==null?void 0:a.message)||"æ›´æ–°ä¹ æƒ¯å¤±è´¥";throw console.error("æ›´æ–°ä¹ æƒ¯å¤±è´¥:",c,e),e}}async function w(s){var o,t;try{await n.deleteHabit(s),i.value=i.value.filter(a=>a.id!==s)}catch(a){const e=(a==null?void 0:a.message)||((t=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:t.message)||"åˆ é™¤ä¹ æƒ¯å¤±è´¥";throw console.error("åˆ é™¤ä¹ æƒ¯å¤±è´¥:",e,a),a}}async function H(s){var o,t;try{const a=i.value.find(e=>e.id===s);a&&(await n.archiveHabit(s,!a.archived),await d())}catch(a){const e=(a==null?void 0:a.message)||((t=(o=a==null?void 0:a.response)==null?void 0:o.data)==null?void 0:t.message)||"å½’æ¡£/å–æ¶ˆå½’æ¡£å¤±è´¥";throw console.error("å½’æ¡£/å–æ¶ˆå½’æ¡£å¤±è´¥:",e,a),a}}function y(){l.value=!l.value}return{habits:i,loading:r,archivedCollapsed:l,activeHabits:u,archivedHabits:h,loadHabits:d,toggleHabit:b,addHabit:m,updateHabit:p,deleteHabit:w,toggleArchiveHabit:H,toggleArchivedCollapsed:y}}),x=(i,r)=>{const l=i.__vccOpts||i;for(const[u,h]of r)l[u]=h;return l};export{x as _,_ as u};
