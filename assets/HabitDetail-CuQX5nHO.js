import{o as r,c as i,a as e,F as V,r as j,n as X,e as te,t as c,i as fe,f as D,d as $,g as me,x as I,b as be,j as ee,p as we,y as ke,k as z,z as xe,l as $e}from"./index-DDPU8cJj.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{H as De}from"./HabitModal-BEaDSf_J.js";const Ce={class:"habit-heatmap"},Se={class:"heatmap-wrapper"},Te=["title"],Me={class:"heatmap-date-label"},He={__name:"HabitHeatmap",props:{heatmap:{type:Array,default:()=>[]},habitColor:{type:String,default:"#10b981"},viewType:{type:String,default:"daily"}},setup(F){const p=F,P=D(()=>{const a=p.heatmap||[];if(p.viewType==="daily"){const d=new Date;d.setHours(0,0,0,0);const h=[],l={};a.forEach(o=>{const y=o.date;if(y){let f=String(y);f.includes(" ")&&(f=f.split(" ")[0]),f.includes("T")&&(f=f.split("T")[0]),l[f]=o}});for(let o=29;o>=0;o--){const y=new Date(d);y.setDate(y.getDate()-o);const f=y.getFullYear(),x=String(y.getMonth()+1).padStart(2,"0"),M=String(y.getDate()).padStart(2,"0"),L=`${f}-${x}-${M}`;l[L]?h.push(l[L]):h.push({date:L,completed:0,level:0})}return h.reverse()}const b=[...a].sort((d,h)=>{const l=new Date(d.date),o=new Date(h.date);return l.getTime()-o.getTime()});let w=12;return p.viewType==="yearly"?w=5:(p.viewType==="weekly"||p.viewType==="monthly")&&(w=12),b.slice(-w).reverse()}),C=a=>a.completed?`day-level-${a.level||3}`:"day-empty",u=a=>{if(!a.completed)return{backgroundColor:"#ebedf0"};const b={0:"#ebedf0",1:"#c6e48b",2:"#7bc96f",3:"#239a3b",4:"#196127"},w=a.level||3;return{backgroundColor:b[w]||b[3]}},k=a=>p.viewType==="weekly"&&a.week_label?`${a.week_label}: ${a.completed?"æœ¬å‘¨å·²å®Œæˆ":"æœ¬å‘¨æœªå®Œæˆ"}`:p.viewType==="monthly"&&a.month_label?`${a.month_label}: ${a.completed?"æœ¬æœˆæœ‰å®Œæˆè®°å½•":"æœ¬æœˆæš‚æ— å®Œæˆè®°å½•"}`:p.viewType==="yearly"&&a.year_label?`${a.year_label}: ${a.completed?"æœ¬å¹´æœ‰å®Œæˆè®°å½•":"æœ¬å¹´æš‚æ— å®Œæˆè®°å½•"}`:`${new Date(a.date).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"})}: ${a.completed?"å·²å®Œæˆ":"æœªå®Œæˆ"}`,m=a=>{if(p.viewType==="weekly"){const y=new Date(a),f=y.getMonth()+1,x=y.getDate();return`${f}/${x}`}if(p.viewType==="monthly"){const y=new Date(a),f=y.getMonth()+1;return`${y.getFullYear()%100}/${f}`}if(p.viewType==="yearly")return`${new Date(a).getFullYear()}å¹´`;const b=new Date(a),w=new Date;w.setHours(0,0,0,0);const d=new Date(b);if(d.setHours(0,0,0,0),d.getTime()===w.getTime())return"ä»Šå¤©";const h=new Date(w);if(h.setDate(h.getDate()-1),d.getTime()===h.getTime())return"æ˜¨å¤©";const l=b.getMonth()+1,o=b.getDate();return`${l}/${o}`};return(a,b)=>(r(),i("div",Ce,[e("div",Se,[(r(!0),i(V,null,j(P.value,(w,d)=>(r(),i("div",{key:d,class:"heatmap-day-wrapper",title:k(w)},[e("div",{class:te(["heatmap-day",C(w)]),style:X(u(w))},null,6),e("div",Me,c(m(w.date)),1)],8,Te))),128))]),b[0]||(b[0]=fe('<div class="heatmap-legend" data-v-09a64157><div class="legend-item" data-v-09a64157><div class="legend-box completed" data-v-09a64157></div><span data-v-09a64157>å·²å®Œæˆ</span></div><div class="legend-item" data-v-09a64157><div class="legend-box incomplete" data-v-09a64157></div><span data-v-09a64157>æœªå®Œæˆ</span></div></div>',1))]))}},Ee=se(He,[["__scopeId","data-v-09a64157"]]),Fe={class:"habit-trend-chart"},Ne={class:"chart-container"},Be={class:"grid-lines"},Pe=["y1","x2","y2"],Le=["y1","x2","y2"],ze=["x","y"],Ve=["id"],je=["d","fill"],Ae=["d","stroke"],Oe=["cx","cy","fill"],Re=["x","y","fill"],Ye={class:"x-axis"},Xe=["x","y"],Ge={class:"y-axis"},Ke=["x","y"],Je={class:"chart-legend"},Ue={class:"legend-item"},We={key:0,class:"legend-item"},Y=600,E=250,g=50,Ze={__name:"HabitTrendChart",props:{data:{type:Array,default:()=>[]},habitColor:{type:String,default:"#10b981"},viewType:{type:String,default:"daily"}},setup(F){const p=F,P=D(()=>{if(p.data.length===0)return 10;const d=Math.max(...p.data.map(h=>h.completed),1);return Math.ceil(d*1.2)}),C=D(()=>p.data.length===0?0:p.data.reduce((h,l)=>h+l.completed,0)/p.data.length),u=D(()=>{if(p.data.length===0)return[];const d=Y-2*g,h=E-2*g,l=p.data.length>1?d/(p.data.length-1):0;return p.data.map((o,y)=>{const f=g+(p.data.length>1?y*l:d/2),x=g+h-o.completed/P.value*h,M=o.period_label||o.month||o.period||"",L=o.period||o.month||"";return{x:f,y:x,value:o.completed,label:`${M}: ${o.completed} æ¬¡`,periodKey:L}})}),k=D(()=>{if(u.value.length===0)return"";if(u.value.length===1)return`M ${u.value[0].x} ${u.value[0].y}`;const d=u.value;let h=`M ${d[0].x} ${d[0].y}`;for(let l=0;l<d.length-1;l++){const o=l>0?d[l-1]:d[l],y=d[l],f=d[l+1],x=l<d.length-2?d[l+2]:d[l+1],M=.5,L=y.x+(f.x-o.x)/6*M,G=y.y+(f.y-o.y)/6*M,Z=f.x-(x.x-y.x)/6*M,K=f.y-(x.y-y.y)/6*M;h+=` C ${L} ${G}, ${Z} ${K}, ${f.x} ${f.y}`}return h}),m=D(()=>{if(u.value.length===0)return"";const d=E-g,h=u.value[0].x,l=u.value[u.value.length-1].x;let o=k.value;return o+=` L ${l} ${d} L ${h} ${d} Z`,o}),a=D(()=>{if(p.data.length===0)return[];const h=(Y-2*g)/Math.max(p.data.length-1,1),l=Math.ceil(p.data.length/6);return p.data.filter((o,y)=>y%l===0||y===p.data.length-1).map((o,y)=>{const f=y*l;let x="";return o.period_label?x=o.period_label:o.month?x=`${o.month.split("-")[1]}æœˆ`:o.period&&(x=o.period),{x:g+f*h,text:x}})}),b=D(()=>{const d=[],h=E-2*g,l=P.value/4;for(let o=0;o<=4;o++)d.push({y:g+h-o/4*h,text:Math.round(l*o)});return d}),w=()=>({daily:"æ¯æœˆå®Œæˆæ¬¡æ•°",weekly:"æ¯å‘¨å®Œæˆæ¬¡æ•°",monthly:"æ¯æœˆå®Œæˆæ¬¡æ•°",yearly:"æ¯å¹´å®Œæˆæ¬¡æ•°"})[p.viewType]||"å®Œæˆæ¬¡æ•°";return(d,h)=>(r(),i("div",Fe,[e("div",Ne,[(r(),i("svg",{width:Y,height:E,class:"chart-svg"},[e("g",Be,[(r(),i(V,null,j(5,l=>e("line",{key:`grid-${l}`,x1:g,y1:g+(E-2*g)/4*(l-1),x2:Y-g,y2:g+(E-2*g)/4*(l-1),stroke:"#e5e5e5","stroke-width":"1"},null,8,Pe)),64))]),C.value>0&&u.value.length>0?(r(),i("line",{key:0,x1:g,y1:g+E-2*g-C.value/P.value*(E-2*g),x2:Y-g,y2:g+E-2*g-C.value/P.value*(E-2*g),stroke:"#999","stroke-width":"1","stroke-dasharray":"4,4",opacity:"0.5"},null,8,Le)):$("",!0),C.value>0&&u.value.length>0?(r(),i("text",{key:1,x:Y-g-5,y:g+E-2*g-C.value/P.value*(E-2*g)-5,"text-anchor":"end","font-size":"9",fill:"#999"}," å¹³å‡: "+c(C.value.toFixed(1)),9,ze)):$("",!0),e("defs",null,[e("linearGradient",{id:`gradient-${F.habitColor.replace("#","")}`,x1:"0%",y1:"0%",x2:"0%",y2:"100%"},[e("stop",{offset:"0%",style:X({stopColor:F.habitColor,stopOpacity:.3})},null,4),e("stop",{offset:"100%",style:X({stopColor:F.habitColor,stopOpacity:.05})},null,4)],8,Ve)]),u.value.length>0?(r(),i("path",{key:2,d:m.value,fill:`url(#gradient-${F.habitColor.replace("#","")})`,class:"area-fill"},null,8,je)):$("",!0),u.value.length>0?(r(),i("path",{key:3,d:k.value,stroke:F.habitColor,"stroke-width":"3",fill:"none",class:"trend-line"},null,8,Ae)):$("",!0),(r(!0),i(V,null,j(u.value,(l,o)=>(r(),i("g",{key:o},[e("circle",{cx:l.x,cy:l.y,r:6,fill:F.habitColor,stroke:"white","stroke-width":"2",class:"data-point"},[e("title",null,c(l.label),1)],8,Oe),e("text",{x:l.x,y:l.y-12,"text-anchor":"middle","font-size":"11","font-weight":"600",fill:F.habitColor,class:"data-label"},c(l.value),9,Re)]))),128)),e("g",Ye,[(r(!0),i(V,null,j(a.value,(l,o)=>(r(),i("text",{key:o,x:l.x,y:E-g+20,"text-anchor":"middle","font-size":"10",fill:"#666"},c(l.text),9,Xe))),128))]),e("g",Ge,[(r(!0),i(V,null,j(b.value,(l,o)=>(r(),i("text",{key:o,x:g-10,y:l.y,"text-anchor":"end","font-size":"10",fill:"#666","dominant-baseline":"middle"},c(l.text),9,Ke))),128))])]))]),e("div",Je,[e("div",Ue,[e("div",{class:"legend-dot",style:X({backgroundColor:F.habitColor})},null,4),e("span",null,c(w()),1)]),C.value>0?(r(),i("div",We,[h[0]||(h[0]=e("div",{class:"legend-dash",style:{borderColor:"#999"}},null,-1)),e("span",null,"å¹³å‡å€¼: "+c(C.value.toFixed(1))+" æ¬¡",1)])):$("",!0)])]))}},qe=se(Ze,[["__scopeId","data-v-0dc53073"]]),Qe={class:"container"},Ie={key:0,class:"detail-header"},et={class:"habit-title"},tt={key:1,class:"loading-container"},st={key:2,class:"detail-content"},at={class:"section-block"},lt={class:"stats-grid"},ot={class:"stat-card"},nt={class:"stat-value"},rt={class:"stat-label"},it={class:"stat-desc"},dt={class:"stat-card"},ct={class:"stat-value"},ut={class:"stat-desc"},vt={class:"stat-card"},ht={class:"stat-value"},yt={class:"stat-label"},pt={class:"stat-desc"},_t={class:"stat-card"},gt={class:"stat-value"},ft={class:"stat-label"},mt={class:"stat-desc"},bt={key:0,class:"section-block"},wt={class:"target-progress-card"},kt={class:"target-progress-header"},xt={key:0,class:"target-progress-text"},$t={key:1,class:"target-progress-text"},Dt={class:"progress-bar"},Ct={key:0,class:"target-remaining"},St={key:0},Tt={key:1,class:"target-remaining"},Mt={key:2,class:"target-remaining"},Ht={key:1,class:"section-block"},Et={class:"section-header"},Ft={class:"section-title"},Nt={key:2,class:"section-block"},Bt={class:"section-header"},Pt={class:"section-title"},Lt={key:3,class:"section-block"},zt={class:"section-header"},Vt={class:"filter-controls"},jt=["value"],At={class:"records-list-container"},Ot={class:"month-header"},Rt={class:"month-label"},Yt={class:"month-count"},Xt={class:"records-grid"},Gt={class:"record-day"},Kt={class:"record-status-icon"},Jt={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ut={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5",opacity:"0.3"},Wt={key:2,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Zt={class:"record-date-text"},qt={key:0,class:"empty-records"},Qt={key:0,class:"pagination"},It=["disabled"],es={class:"page-info"},ts=["disabled"],ss={key:4,class:"section-block"},as={class:"section-header"},ls={class:"section-title"},os={class:"records-list-container"},ns={class:"period-records-grid"},rs={class:"period-label"},is={class:"period-status-icon"},ds={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},cs={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},us={class:"period-count"},vs={key:0,class:"empty-records"},hs={__name:"HabitDetail",setup(F){const p=xe(),P=$e(),C=z(!0),u=z({id:null,name:"",emoji:"ğŸ“",color:"#10b981"}),k=z({total_days:0,completed_days:0,completion_rate:0,current_streak:0,longest_streak:0,total_records:0}),m=z(null),a=z(null),b=z([]),w=z(""),d=z(1),h=D(()=>{const t=new Set;return b.value.forEach(s=>{const v=s.record_date||s.date;if(v){let n=String(v);n.includes(" ")&&(n=n.split(" ")[0]),n.includes("T")&&(n=n.split("T")[0]);const _=n.substring(0,7);_&&_.match(/^\d{4}-\d{2}$/)&&t.add(_)}}),Array.from(t).sort().reverse()}),l=D(()=>{const t={};return b.value.forEach(s=>{const v=s.record_date||s.date;if(v){let n=String(v);n.includes(" ")&&(n=n.split(" ")[0]),n.includes("T")&&(n=n.split("T")[0]);const _=s.completed,A=_===1||_===!0||String(_)==="1";t[n]=A}}),a.value&&a.value.heatmap&&a.value.view_type==="daily"&&a.value.heatmap.forEach(s=>{const v=s.date;if(v){let n=String(v);n.includes(" ")&&(n=n.split(" ")[0]),n.includes("T")&&(n=n.split("T")[0]),n in t||(s.completed===1||s.completed===!0||String(s.completed)==="1")&&(t[n]=!0)}}),t}),o=D(()=>{if(b.value.length===0)return null;let t=null;return b.value.forEach(s=>{const v=s.record_date||s.date;if(v){let n=String(v);n.includes(" ")&&(n=n.split(" ")[0]),n.includes("T")&&(n=n.split("T")[0]);const _=new Date(n);(!t||_<t)&&(t=_)}}),t}),y=D(()=>{const t=new Date,s=t.getFullYear(),v=t.getMonth(),n=t.getDate(),_=new Date(s,v,n),A=[];if(w.value){const[N,S]=w.value.split("-").map(Number),B=new Date(N,S,0).getDate();for(let H=1;H<=B;H++){const T=`${N}-${String(S).padStart(2,"0")}-${String(H).padStart(2,"0")}`,O=new Date(N,S-1,H),R=l.value[T],J=R!==void 0,U=o.value&&O<o.value,W=!J&&(O>_||U),Q=R===!0;A.push({date:T,completed:Q,isFuture:W})}}else{if(b.value.length===0)return[];const N=new Set;if(b.value.forEach(B=>{const H=B.record_date||B.date;if(H){let T=String(H);T.includes(" ")&&(T=T.split(" ")[0]),T.includes("T")&&(T=T.split("T")[0]);const O=T.substring(0,7);O&&O.match(/^\d{4}-\d{2}$/)&&N.add(O)}}),N.size===0)return[];Array.from(N).sort().forEach(B=>{const[H,T]=B.split("-").map(Number),O=new Date(H,T,0).getDate();for(let R=1;R<=O;R++){const J=`${H}-${String(T).padStart(2,"0")}-${String(R).padStart(2,"0")}`,U=new Date(H,T-1,R),W=l.value[J],Q=W!==void 0,pe=o.value&&U<o.value,_e=!Q&&(U>_||pe),ge=W===!0;A.push({date:J,completed:ge,isFuture:_e})}})}return A.sort((N,S)=>N.date.localeCompare(S.date)),A}),f=D(()=>{const t={};y.value.forEach(S=>{const B=S.date.substring(0,7);t[B]||(t[B]=[]),t[B].push(S)}),Object.keys(t).forEach(S=>{t[S].sort((B,H)=>B.date.localeCompare(H.date))});const s=Object.keys(t).sort().reverse(),v=2,n=(d.value-1)*v,_=n+v,A=s.slice(n,_),N={};return A.forEach(S=>{N[S]=t[S]}),N}),x=t=>t.filter(s=>s.completed).length,M=D(()=>{const t=new Set;y.value.forEach(n=>{const _=n.date.substring(0,7);t.add(_)});const s=t.size;return Math.max(1,Math.ceil(s/2))}),L=()=>{d.value=1};me(async()=>{await G()});const G=async()=>{try{C.value=!0;const t=await I.getHabitDetail(p.params.id);if(t&&t.habit)u.value={id:t.habit.id,name:t.habit.name||"",emoji:t.habit.emoji||"ğŸ“",color:t.habit.color||"#10b981",...t.habit},k.value=t.stats||k.value,m.value=t.target_progress||null,a.value=t.view_data||null,!a.value&&(t.heatmap||t.monthly_trend)&&(a.value={view_type:"daily",heatmap:t.heatmap||[],trend:t.monthly_trend||[],trend_label:"æœˆåº¦è¶‹åŠ¿"}),b.value=t.recent_records||[];else throw new Error("è¿”å›æ•°æ®æ ¼å¼é”™è¯¯: "+JSON.stringify(t))}catch(t){console.error("åŠ è½½ä¹ æƒ¯è¯¦æƒ…å¤±è´¥:",t),console.error("å®Œæ•´å“åº”:",t.response||t),alert("åŠ è½½å¤±è´¥: "+(t.message||"æœªçŸ¥é”™è¯¯")),P.push("/")}finally{C.value=!1}},Z=()=>{P.push("/")},K=z(!1),oe=D(()=>!u.value||!u.value.id?null:{id:u.value.id,name:u.value.name,emoji:u.value.emoji,color:u.value.color,target_type:u.value.target_type||"daily",target_count:u.value.target_count||1,target_start_date:u.value.target_start_date||new Date().toISOString().split("T")[0],archived:u.value.archived||!1}),q=()=>{K.value=!1},ne=async t=>{try{await I.updateHabit(u.value.id,t),await G(),q()}catch(s){console.error("æ›´æ–°ä¹ æƒ¯å¤±è´¥:",s),alert("æ›´æ–°ä¹ æƒ¯å¤±è´¥: "+((s==null?void 0:s.message)||"æœªçŸ¥é”™è¯¯"))}},re=async()=>{try{const t=!u.value.archived;await I.archiveHabit(u.value.id,t),await G(),q(),t&&P.push("/")}catch(t){console.error("å½’æ¡£æ“ä½œå¤±è´¥:",t),alert("å½’æ¡£æ“ä½œå¤±è´¥: "+((t==null?void 0:t.message)||"æœªçŸ¥é”™è¯¯"))}},ie=()=>m.value&&{daily:"æ¯å¤©",weekly:"æ¯å‘¨",monthly:"æ¯æœˆ",yearly:"æ¯å¹´"}[m.value.target_type]||"",ae=()=>m.value&&{daily:"æœ¬æ—¥",weekly:"æœ¬å‘¨",monthly:"æœ¬æœˆ",yearly:"æœ¬å¹´"}[m.value.target_type]||"æœ¬å‘¨æœŸ",le=D(()=>m.value?Number(m.value.completed||0)>=Number(m.value.target_count||0):!1),de=()=>!k.value||!k.value.target_type?"ä»æœ€æ—©è®°å½•åˆ°ä»Šå¤©":{daily:"ä»æœ€æ—©è®°å½•åˆ°ä»Šå¤©",weekly:"ä»æœ€æ—©è®°å½•å‘¨åˆ°ä»Šå¤©",monthly:"ä»æœ€æ—©è®°å½•æœˆåˆ°ä»Šå¤©",yearly:"ä»æœ€æ—©è®°å½•å¹´åˆ°ä»Šå¤©"}[k.value.target_type]||"ä»æœ€æ—©è®°å½•åˆ°ä»Šå¤©",ce=()=>!a.value||!a.value.view_type?"æœ€è¿‘ä¸‰åå¤©æ‰“å¡æ—¥å†":{daily:"æœ€è¿‘ä¸‰åå¤©æ‰“å¡æ—¥å†",weekly:"æœ€è¿‘å‘¨æ‰“å¡æ—¥å†",monthly:"æœ€è¿‘æœˆæ‰“å¡æ—¥å†",yearly:"å¹´åº¦æ‰“å¡æ—¥å†"}[a.value.view_type]||"æœ€è¿‘ä¸‰åå¤©æ‰“å¡æ—¥å†",ue=()=>!a.value||!a.value.view_type?"æ‰“å¡è®°å½•":{daily:"æ‰“å¡è®°å½•",weekly:"å‘¨æ‰“å¡è®°å½•",monthly:"æœˆæ‰“å¡è®°å½•",yearly:"å¹´æ‰“å¡è®°å½•"}[a.value.view_type]||"æ‰“å¡è®°å½•",ve=t=>new Date(t).toLocaleDateString("zh-CN",{month:"short",day:"numeric"}),he=t=>{if(!t)return"";if(!t.match(/^\d{4}-\d{2}$/))return t;const[s,v]=t.split("-"),n=parseInt(v,10);return isNaN(n)||n<1||n>12?t:`${s}å¹´${["ä¸€æœˆ","äºŒæœˆ","ä¸‰æœˆ","å››æœˆ","äº”æœˆ","å…­æœˆ","ä¸ƒæœˆ","å…«æœˆ","ä¹æœˆ","åæœˆ","åä¸€æœˆ","åäºŒæœˆ"][n-1]}`},ye=t=>new Date(t).getDate();return(t,s)=>(r(),i("div",Qe,[u.value&&u.value.id?(r(),i("header",Ie,[e("button",{class:"back-btn",onClick:Z},[...s[4]||(s[4]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1)])]),e("div",et,[e("span",{class:"habit-emoji",style:X({background:`${u.value.color||"#10b981"}20`,color:u.value.color||"#10b981"})},c(u.value.emoji||"ğŸ“"),5),e("h1",null,c(u.value.name||"åŠ è½½ä¸­..."),1)]),e("button",{class:"edit-btn",onClick:s[0]||(s[0]=v=>K.value=!0),title:"ç¼–è¾‘ä¹ æƒ¯"},[...s[5]||(s[5]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),e("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})],-1)])])])):$("",!0),C.value?(r(),i("div",tt,[...s[6]||(s[6]=[e("div",{class:"loading"},"åŠ è½½ä¸­...",-1)])])):u.value&&u.value.id?(r(),i("div",st,[e("section",at,[e("div",lt,[e("div",ot,[e("div",nt,c(k.value.total_periods||0),1),e("div",rt,c(k.value.total_periods_label||"æ€»å¤©æ•°"),1),e("div",it,c(de()),1)]),e("div",dt,[e("div",ct,c(k.value.completion_rate||0)+"%",1),s[7]||(s[7]=e("div",{class:"stat-label"},"å®Œæˆç‡",-1)),e("div",ut,c(k.value.completion_rate_desc||"å·²å®Œæˆæ•° / æ€»æ•°"),1)]),e("div",vt,[e("div",ht,c(k.value.current_streak||0),1),e("div",yt,c(k.value.current_streak_label||"è¿ç»­å¤©æ•°"),1),e("div",pt,c(k.value.current_streak_desc||"å½“å‰è¿ç»­å®Œæˆå¤©æ•°"),1)]),e("div",_t,[e("div",gt,c(k.value.longest_streak||0),1),e("div",ft,c(k.value.longest_streak_label||"æœ€é•¿è¿ç»­"),1),e("div",mt,c(k.value.longest_streak_desc||"å†å²æœ€é•¿è¿ç»­å¤©æ•°"),1)])])]),m.value?(r(),i("section",bt,[e("div",wt,[e("div",kt,[e("h3",null,c(ie())+"ç›®æ ‡è¿›åº¦",1),le.value?(r(),i("span",$t,c(ae())+"å·²å®Œæˆ "+c(m.value.completed)+" æ¬¡ ",1)):(r(),i("span",xt,c(m.value.completed)+" / "+c(m.value.target_count)+" æ¬¡ ",1))]),e("div",Dt,[e("div",{class:"progress-fill",style:X({width:`${m.value.progress}%`,backgroundColor:u.value.color||"#10b981"})},null,4)]),le.value?(r(),i("div",Ct,[s[8]||(s[8]=be(" æœ¬å‘¨æœŸç›®æ ‡å·²å®Œæˆ ",-1)),m.value.completed>m.value.target_count?(r(),i("span",St," ï¼Œå·²è¶…å‡º "+c(m.value.completed-m.value.target_count)+" æ¬¡ ",1)):$("",!0)])):m.value.remaining_days>0?(r(),i("div",Tt," è¿˜å‰© "+c(m.value.remaining_days)+" å¤©å®Œæˆç›®æ ‡ ",1)):(r(),i("div",Mt,c(ae())+"ç›®æ ‡æœªå®Œæˆ ",1))])])):$("",!0),a.value&&a.value.heatmap?(r(),i("section",Ht,[e("div",Et,[e("h2",Ft,c(ce()),1)]),ee(Ee,{heatmap:a.value.heatmap,"habit-color":u.value.color||"#10b981","view-type":a.value.view_type||"daily"},null,8,["heatmap","habit-color","view-type"])])):$("",!0),a.value&&a.value.trend?(r(),i("section",Nt,[e("div",Bt,[e("h2",Pt,c(a.value.trend_label||"è¶‹åŠ¿"),1)]),ee(qe,{data:a.value.trend,"habit-color":u.value.color||"#10b981","view-type":a.value.view_type||"daily"},null,8,["data","habit-color","view-type"])])):$("",!0),a.value&&a.value.view_type==="daily"?(r(),i("section",Lt,[e("div",zt,[s[10]||(s[10]=e("h2",{class:"section-title"},"æ‰“å¡è®°å½•",-1)),e("div",Vt,[we(e("select",{"onUpdate:modelValue":s[1]||(s[1]=v=>w.value=v),class:"filter-select",onChange:L},[s[9]||(s[9]=e("option",{value:""},"å…¨éƒ¨æœˆä»½",-1)),(r(!0),i(V,null,j(h.value,v=>(r(),i("option",{key:v,value:v},c(v),9,jt))),128))],544),[[ke,w.value]])])]),e("div",At,[(r(!0),i(V,null,j(f.value,(v,n)=>(r(),i("div",{key:n,class:"record-month-group"},[e("div",Ot,[e("span",Rt,c(he(n)),1),e("span",Yt,c(x(v))+" / "+c(v.length)+" å¤© ",1)]),e("div",Xt,[(r(!0),i(V,null,j(v,_=>(r(),i("div",{key:_.date,class:te(["record-card",{completed:_.completed&&!_.isFuture,incomplete:!_.completed&&!_.isFuture,future:_.isFuture}])},[e("div",Gt,c(ye(_.date)),1),e("div",Kt,[_.completed?(r(),i("svg",Jt,[...s[11]||(s[11]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):_.isFuture?(r(),i("svg",Ut,[...s[12]||(s[12]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1)])])):(r(),i("svg",Wt,[...s[13]||(s[13]=[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1)])]))]),e("div",Zt,c(ve(_.date)),1)],2))),128))])]))),128)),y.value.length===0?(r(),i("div",qt,[...s[14]||(s[14]=[e("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1),e("p",null,"æš‚æ— è®°å½•",-1)])])):$("",!0)]),M.value>1?(r(),i("div",Qt,[e("button",{class:"page-btn",disabled:d.value===1,onClick:s[2]||(s[2]=v=>d.value--)}," ä¸Šä¸€é¡µ ",8,It),e("span",es,"ç¬¬ "+c(d.value)+" / "+c(M.value)+" é¡µ",1),e("button",{class:"page-btn",disabled:d.value===M.value,onClick:s[3]||(s[3]=v=>d.value++)}," ä¸‹ä¸€é¡µ ",8,ts)])):$("",!0)])):$("",!0),a.value&&a.value.view_type!=="daily"&&a.value.trend?(r(),i("section",ss,[e("div",as,[e("h2",ls,c(ue()),1)]),e("div",os,[e("div",ns,[(r(!0),i(V,null,j(a.value.trend,(v,n)=>(r(),i("div",{key:n,class:te(["period-record-card",{completed:v.completed>0,incomplete:v.completed===0}])},[e("div",rs,c(v.period_label||v.period||v.month),1),e("div",is,[v.completed>0?(r(),i("svg",ds,[...s[15]||(s[15]=[e("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(r(),i("svg",cs,[...s[16]||(s[16]=[e("line",{x1:"18",y1:"6",x2:"6",y2:"18"},null,-1),e("line",{x1:"6",y1:"6",x2:"18",y2:"18"},null,-1)])]))]),e("div",us,c(v.completed)+" / "+c(v.total),1)],2))),128))]),!a.value.trend||a.value.trend.length===0?(r(),i("div",vs,[...s[17]||(s[17]=[e("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})],-1),e("p",null,"æš‚æ— è®°å½•",-1)])])):$("",!0)])])):$("",!0)])):$("",!0),ee(De,{show:K.value,"editing-habit":oe.value,onClose:q,onSubmit:ne,onArchive:re},null,8,["show","editing-habit"])]))}},gs=se(hs,[["__scopeId","data-v-328f3507"]]);export{gs as default};
